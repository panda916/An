USE [DIVA_SAP_USAGE_S4]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[script_BC25_IT_MARC_T001W_MAKT_DESC]
AS
--DYNAMIC_SCRIPT_START
--Objective:Add description for plants and material number in MARC table 

EXEC SP_DROPTABLE BC25_01_IT_MARC_T001W_MAKT_DESC
SELECT DISTINCT
        MARC_WERKS+'-'+T001W_NAME1 AS ZF_MARC_WERKS_DESC,
		MARC_WERKS,
		MARC_MATNR+'-'+MAKT_MAKTX AS ZF_MARC_MATNR_DESC,
		MARC_MATNR,
		MARC_ABCIN,
		MARC_MANDT,
	    T001W_NAME1,
		T001W_WERKS,
		MARC_UEETK,
		MARC_UEETO,
		MARC_UNETO
INTO BC25_01_IT_MARC_T001W_MAKT_DESC
FROM A_MARC
LEFT JOIN 
A_T001W
ON MARC_WERKS = T001W_WERKS
LEFT JOIN A_MAKT
ON MAKT_MATNR = MARC_MATNR

GO
