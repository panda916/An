USE [DIVA_SAP_USAGE_S4]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE  [dbo].[script_SU82_Identify company code are set to productive]
AS 
--DYNAMIC_SCRIPT_START

--Script objective: Indentify the company code are set to productive

--Step 1 Get the list of company code , flag the case are set to productive
EXEC SP_DROPTABLE SU82_01_RT_T001_ADD_XPROD_FLAG

SELECT DISTINCT 
BC07_01_T001_MANDT,
BC07_01_T001_BUKRS,
BC07_01_T001_BUTXT,
BC07_01_T001_XPROD,
BC07_01_T001_KTOPL,
BC07_01_T004T_KTPLT,
IIF(BC07_01_T001_XPROD='X','Yes','') AS ZF_T001_XPROD_FLAG
INTO SU82_01_RT_T001_ADD_XPROD_FLAG
FROM BC07_01_IT_T001_T009_T001B_T000

--Rename fields
EXEC SP_UNNAME_FIELD 'BC07_01_','SU82_01_RT_T001_ADD_XPROD_FLAG'
EXEC SP_RENAME_FIELD 'SU82_01_','SU82_01_RT_T001_ADD_XPROD_FLAG'

GO
