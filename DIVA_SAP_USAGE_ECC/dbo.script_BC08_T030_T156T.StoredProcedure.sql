USE [DIVA_SAP_USAGE_ECC]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[script_BC08_T030_T156T]
AS
--DYNAMIC_SCRIPT_START
--Script objective :
--Create Standard Accounts cube

--Step 1 Get the information about standard accounts
--
EXEC SP_DROPTABLE 'BC08_01_IT_T030_T156T'

SELECT DISTINCT
	T030_MANDT,
	T030_KTOPL,	
	T030_KTOSL,	
	T030_BWMOD,
	T030_KOMOK,	
	T030_BKLAS,	
	T030_KONTS,	
	T030_KONTH, 
	--	Valuation Class description
	IIF(T025T_BKBEZ IS NULL OR LEN(TRIM(T025T_BKBEZ))=0, 'No description',T025T_BKBEZ) AS ZF_T025T_BKBEZ_DESCRIPTION
INTO BC08_01_IT_T030_T156T
FROM A_T030
	--	Add Valuation Class description
LEFT JOIN A_T025T
ON T025T_BKLAS=T030_BKLAS

--Rename the fields
EXEC SP_RENAME_FIELD 'BC08_01_','BC08_01_IT_T030_T156T'


GO
