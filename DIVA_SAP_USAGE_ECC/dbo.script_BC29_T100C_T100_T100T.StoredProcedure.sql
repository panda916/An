USE [DIVA_SAP_USAGE_ECC]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[script_BC29_T100C_T100_T100T]
AS
--DYNAMIC_SCRIPT_START
--Step 1/
--Create the cube for Message Control by User information
--Add description for message
--Add name of the user
EXEC SP_DROPTABLE BC29_01_IT_T100C_T100_T100T

SELECT DISTINCT
	A_T100C.* ,
	CASE WHEN T100C_MSGTS='S' THEN 'Success'
		WHEN T100C_MSGTS='I' THEN 'Information'
		WHEN T100C_MSGTS='W' THEN 'Warning'
		WHEN T100C_MSGTS='E' THEN 'Error'
		WHEN T100C_MSGTS='A' THEN 'Abend'
		ELSE 'Not found' END AS ZF_T100C_MSGTS_DESC,
	CASE WHEN T100C_MSGTB='S' THEN 'Success'
		WHEN T100C_MSGTB='I' THEN 'Information'
		WHEN T100C_MSGTB='W' THEN 'Warning'
		WHEN T100C_MSGTB='E' THEN 'Error'
		WHEN T100C_MSGTB='A' THEN 'Abend'
		ELSE 'Not foound' END AS ZF_T100C_MSGTB_DESC,
		USER_ADDR_NAME_TEXTC,
	IIF(LEN(TRIM(USER_ADDR_NAME_TEXTC))=0 OR USER_ADDR_NAME_TEXTC IS NULL,'Not found',USER_ADDR_NAME_TEXTC) AS ZF_USER_ADDR_NAME_TEXTC
--	,A_T100.T100_TEXT
,A_T100T.T100T_STEXT
INTO BC29_01_IT_T100C_T100_T100T
FROM A_T100C
--Add the Application Area text description
LEFT JOIN A_T100T
ON T100T_ARBGB=T100C_ARBGB AND T100T_SPRSL='EN'
--Add name of the user
LEFT JOIN A_USER_ADDR
	ON USER_ADDR_BNAME=T100C_UNAME


--Rename the fields
EXEC SP_RENAME_FIELD 'BC29_01_','BC29_01_IT_T100C_T100_T100T'



GO
